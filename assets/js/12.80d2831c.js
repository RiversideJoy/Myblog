(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{326:function(s,a,e){s.exports=e.p+"assets/img/summary.ecc37d3d.png"},327:function(s,a,e){s.exports=e.p+"assets/img/masterToDev.97222660.png"},328:function(s,a,e){s.exports=e.p+"assets/img/no-ff.a5e10cb7.png"},329:function(s,a,e){s.exports=e.p+"assets/img/feature.cfb73518.png"},330:function(s,a,e){s.exports=e.p+"assets/img/hotfix.4241c094.png"},495:function(s,a,e){"use strict";e.r(a);var t=e(7),r=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"分支策略-git-flow"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分支策略-git-flow"}},[s._v("#")]),s._v(" 分支策略-Git flow")]),s._v(" "),a("p",[s._v("关于Git分支策略最早的见于Vincent在2010年发表的一篇博文《A successful Git branching model》")]),s._v(" "),a("p",[a("img",{attrs:{src:e(326),alt:"全局图"}})]),s._v(" "),a("h2",{attrs:{id:"分支分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分支分类"}},[s._v("#")]),s._v(" 分支分类")]),s._v(" "),a("p",[s._v("在这种模式下，主要维护了两类分支：")]),s._v(" "),a("h3",{attrs:{id:"主要分支"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主要分支"}},[s._v("#")]),s._v(" 主要分支")]),s._v(" "),a("ol",[a("li",[s._v("master")]),s._v(" "),a("li",[s._v("develop")])]),s._v(" "),a("h3",{attrs:{id:"辅助分支"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#辅助分支"}},[s._v("#")]),s._v(" 辅助分支")]),s._v(" "),a("ol",[a("li",[s._v("feature branch (功能分支)")]),s._v(" "),a("li",[s._v("release branch (预发布分支)")]),s._v(" "),a("li",[s._v("hotfix branch (热修复分支)")])]),s._v(" "),a("h2",{attrs:{id:"分支作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分支作用"}},[s._v("#")]),s._v(" 分支作用")]),s._v(" "),a("h3",{attrs:{id:"master"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#master"}},[s._v("#")]),s._v(" master")]),s._v(" "),a("p",[s._v("首先，代码库应该有一个、且仅有一个主分支。master 分支的代码永远是稳定的，可以随时发布到生产环境。")]),s._v(" "),a("h3",{attrs:{id:"develop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#develop"}},[s._v("#")]),s._v(" develop")]),s._v(" "),a("p",[s._v("develop 分支用于日常开发，保存了开发过程中最新的代码。")]),s._v(" "),a("p",[s._v("当 develop 分支上的代码达到稳定，并且具备发版状态时，需要将 develop 的代码合并到 master，并且打一个带有发布版本号的 tag。")]),s._v(" "),a("p",[a("img",{attrs:{src:e(327),alt:""}})]),s._v(" "),a("h3",{attrs:{id:"从master创建dev-并合并到master"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从master创建dev-并合并到master"}},[s._v("#")]),s._v(" 从master创建dev，并合并到master")]),s._v(" "),a("p",[s._v("创建 develop 分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" develop master\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("将 develop 合并到 master：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换到 master 分支")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout master\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对 develop 分支进行合并")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --no-ff develop\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("code",[s._v("--no-ff")]),s._v(" 参数的作用是使当前的合并操作总是创建一个新的 commit 对象，即使该合并被执行为快进式（fast-forward）合并。")]),s._v(" "),a("p",[s._v("这样可以避免丢失掉该功能分支的历史信息，并且将针对该功能的所有提交都集中到一起。这样解释也并不是很易懂，通过下图来对比一下就比较明显了：")]),s._v(" "),a("p",[a("img",{attrs:{src:e(328),alt:""}})]),s._v(" "),a("h3",{attrs:{id:"feature功能分支"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#feature功能分支"}},[s._v("#")]),s._v(" feature功能分支")]),s._v(" "),a("ul",[a("li",[s._v("分支来源：develop")]),s._v(" "),a("li",[s._v("合并到分支：develop")]),s._v(" "),a("li",[s._v("分支命名约定：feature-*")])]),s._v(" "),a("p",[s._v("功能分支，在开发某一个新功能时，从 develop 分支分出来，开发完之后，再合并回 develop 分支。")]),s._v(" "),a("p",[s._v("功能分支通常只存在于开发者的本地仓库中，并不包含在远程库中。")]),s._v(" "),a("p",[a("img",{attrs:{src:e(329),alt:""}})]),s._v(" "),a("p",[s._v("创建一个功能分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" feature-x develop\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("开发完成后，将功能分支合并到 develop 分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout develop\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --no-ff feature-x\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("删除 feature 分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" branch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" feature-x\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"release"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#release"}},[s._v("#")]),s._v(" release")]),s._v(" "),a("p",[s._v("分支来源：develop\n合并到分支：develop，master\n分支命名约定：release-*\n预发布分支，它是指发布正式版本之前，我们可能需要有一个预发布的版本测试，并且可以在上面做一些较小 bug 的修复。")]),s._v(" "),a("p",[s._v("预发布分支是从 develop 分支上分出来的，预发布结束以后，必须合并进 develop 和 master 分支。")]),s._v(" "),a("p",[s._v("创建一个预发布分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" release-1.2 develop\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("确认没有问题后，合并到 master 分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout master\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --no-ff release-1.2\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对合并生成的新节点，做一个标签")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" tag "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("最后，删除预发布分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" branch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" release-1.2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"hotfix"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hotfix"}},[s._v("#")]),s._v(" hotfix")]),s._v(" "),a("p",[s._v("分支来源：master\n合并到分支：develop，master\n分支命名约定：hotfix-*\n最后一种是修复 bug 分支。软件正式发布以后，难免会出现 bug。这时就需要创建一个分支，进行 bug 修复。")]),s._v(" "),a("p",[s._v("修复 bug 分支是从 master 分支上分出来的。修复结束以后，再合并进 master 和 develop 分支。")]),s._v(" "),a("p",[a("img",{attrs:{src:e(330),alt:""}})]),s._v(" "),a("p",[s._v("创建一个修复 bug 分支")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" hotfix-0.1 master\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("修复结束后，合并到 master 分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout master\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --no-ff hotfix-0.1\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" tag "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v(".1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("再合并到 develop 分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout develop\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge --no-ff hotfix-0.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("最后，删除修复 bug 分支：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" branch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" hotfix-0.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("小结")]),s._v(" "),a("p",[s._v("优点：各分支权责分明，清晰可控，是很多分支管理策略的启蒙模型。")]),s._v(" "),a("p",[s._v("缺点：")]),s._v(" "),a("p",[s._v("合并冲突：同时长期存在的分支可能会很多：master、develop、release、hotfix、若干并行的 feature 分支。两两之间都有可能发生冲突。频繁手动解决冲突不仅增加工作量，而且增大了出错的风险。\n功能分离：功能并行开发时，合并分支前无法测试组合功能，而且合并后可能会出现互相影响。\n无法持续交付：Git flow 更倾向于按计划发布，一个 feature 要经历很多步骤才能发布到正式环境，难以达到持续交付的要求。\n无法持续集成：持续集成鼓励更加频繁的代码集成和交互，尽早解决冲突，而 Git flow 的分支策略隔离了代码，尽可能推迟代码集成。")])])}),[],!1,null,null,null);a.default=r.exports}}]);